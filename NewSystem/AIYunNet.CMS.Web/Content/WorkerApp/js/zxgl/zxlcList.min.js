jQuery(function (t) { "undefined" != typeof FastClick && FastClick.attach(document.body); var e = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function (t) { setTimeout(t, 1e3 / 60) }, i = function (t) { this._$container = t, this._init() }; i.prototype = { constructor: i, _init: function () { var t = this; this._$zxlcBtn = this._$container.find(".zxlc-btn"), this._$listHd = this._$container.find(".zxlc-list-hd"), this._$listBd = this._$container.find(".zxlc-list-bd"), this._$phaseLis = this._$container.find(".zxlc-phase"), this._$stepNames = this._$container.find(".zxlc-step-name"), this._$container.find(".zxlc-types a").on("touchstart", function (t) { return t.preventDefault(), location.href = this.href, !1 }), this._$container.find(".zxlc-types-scroll-wrapper,.zxlc-list-conditions-scroll-wrapper,.zxlc-steps").click(function () { return !1 }), this._refreshPhaseUlHeight(), this._scroll = new IScroll(".zxlc-list-conditions-scroll-wrapper", { probeType: 3, bounce: !1 }), this._scroll.on("scroll", function () { e(function () { t._zxlcConditionScrollhandler() }) }), this._scroll.on("scrollEnd", function () { e(function () { t._zxlcConditionScrollhandler() }), setTimeout(function () { t._zxlcConditionScrollhandler() }, 300), setTimeout(function () { t._zxlcConditionScrollhandler() }, 500), setTimeout(function () { t._zxlcConditionScrollhandler() }, 1e3) }), this._regEvent() }, _stopScroll: function () { document.body.style.position = "fixed", document.body.style.overflow = "hidden" }, _releaseScroll: function () { document.body.style.position = "static", document.body.style.overflow = "auto" }, _refreshScroll: function () { this._scroll.refresh() }, _regEvent: function () { this._$listBd.click(t.proxy(this._zxlcOverlayClickHandler, this)), this._$zxlcBtn.click(t.proxy(this._zxlcBtnClickHandler, this)), this._$phaseLis.click(t.proxy(this._phaseLiClickHandler, this)), this._$stepNames.on("touchstart", t.proxy(this._stepNamesClickHandler, this)), t(window).bind("resize orientationchange", t.proxy(this._orientationchangeHandler, this)) }, _zxlcConditionScrollhandler: function () { var t = this._$container.find(".active-zxlc-phase .zxlc-phase-name"), e = t.next(), i = this; this._$listBd.hasClass("active-zxlc-list-bd") ? 0 != e.length && (e.position().top < 44 ? (this._$activeStepsClone || (this._$activeStepsClone = t.clone(), this._$activeStepsClone.click(function () { return i._$container.find(".active-zxlc-phase").click(), !1 }), this._$activeStepsClone.addClass("fixed"), this._$container.after(this._$activeStepsClone)), this._$activeStepsClone.text(t.text()).show()) : this._$activeStepsClone && this._$activeStepsClone.hide()) : this._resetFixed() }, _zxlcOverlayClickHandler: function (t) { this._$zxlcBtn.trigger("click") }, _zxlcBtnClickHandler: function (e) { return this._$listBd.hasClass("active-zxlc-list-bd") ? (this._$listBd.children().removeClass("slideIn").addClass("slideOut"), this._$listBd.removeClass("active-zxlc-list-bd"), this._resetFixed(), e.stopImmediatePropagation(), t(".zx-list-wrap").addClass("mar-95"), t("#dt-hd").removeClass("top0"), "334px" == t(".whan-ad").css("bottom") && t(".top-banner-remove").removeClass("mar-95"), t(".cc-box").length >= 1 && t(".cc-box-style").length < 1 && t(".cc-box").addClass("cc-box-style"), t(".cc-box").length >= 1 && t(".cc-box-style").length < 1 && t(".cc-box").addClass("cc-box-style"), this._releaseScroll(), this._resetFixed(), t(".zxlc-btn").show(), !1) : (this._$listBd.css("top", this._$listHd.offset().top + this._$listHd.outerHeight()), t(".top-banner-remove").removeClass("mar-95"), t(".zx-list-wrap").addClass("mar-95"), t(".zxlc-list-wrap").addClass("mar-95"), "334px" == t(".whan-ad").css("bottom") && t(".zxlc-list-wrap").addClass("mar-45"), t(".cc-box-style").length >= 1 && t(".cc-box").removeClass("cc-box-style"), this._stopScroll(), this._$listBd.addClass("active-zxlc-list-bd").children().addClass("slideIn").removeClass("slideOut"), t(".zxlc-btn").hide(), 0 == this._$phaseLis.filter(".active-zxlc-phase").length && this._$phaseLis.eq(0).find(".zxlc-phase-name").click(), this._refreshPhaseUlHeight(), this._refreshScroll(), this._scroll.scrollToElement(this._$phaseLis.filter(".active-zxlc-phase").get(0), 0), !1) }, _phaseLiClickHandler: function (e) { var i = t(e.currentTarget); return i.hasClass("active-zxlc-phase") ? (this._$activePhaseLi = t(), i.removeClass("active-zxlc-phase")) : (this._$phaseLis.removeClass("active-zxlc-phase"), i.addClass("active-zxlc-phase"), this._$activePhaseLi = i, 0 == i.find(".zxlc-steps > li.active-zxlc-step").length && i.find(".zxlc-steps > li .zxlc-step-name").eq(0).click()), this._resetFixed(), this._refreshPhaseUlHeight(), this._refreshScroll(), this._scroll.scrollToElement(i.get(0), 0), !1 }, _stepNamesClickHandler: function (e) { e.preventDefault(); var i = t(e.currentTarget); return i.parent().siblings().removeClass("active-zxlc-step"), i.parent().addClass("active-zxlc-step"), this._resetFixed(), this._refreshPhaseUlHeight(), this._refreshScroll(), this._zxlcConditionScrollhandler(), i.find("a").attr("href") && (location.href = i.find("a").attr("href")), !1 }, _refreshPhaseUlHeight: function () { var e = this; this._$phaseLis.each(function (i, s) { var l, n, c = t(s).find(".zxlc-steps > li"), a = 36 * c.length, o = c.filter(".active-zxlc-step"); if (0 == o.length && (o = c.eq(0)), n = o.find(".zxlc-types li"), l = Math.max(36 * n.length, a), t(s).find(".zxlc-steps").height(l), t(s).is(".active-zxlc-phase:last-child")) { var r = e._$listBd.height() - e._$container.find(".zxlc-list-conditions").height(); r > 0 && (l += r, t(s).find(".zxlc-steps").height(l)) } }) }, _orientationchangeHandler: function () { this._refreshPhaseUlHeight(), this._refreshScroll(), this._zxlcConditionScrollhandler() }, _resetFixed: function () { this._$activeStepsClone && this._$activeStepsClone.hide() } }, new i(t(".zxlc-list-hd-wrap")) });